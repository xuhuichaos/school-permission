{"version":3,"file":"js/491.7fd7b28f.js","mappings":"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","sources":["webpack://quanxiang/./src/renderTime.js","webpack://quanxiang/./src/components/power/Roles.vue","webpack://quanxiang/./src/components/power/Roles.vue?c0d5"],"sourcesContent":["// 处理后台发送的数据库返回的时间格式\nconst renderTime = (list, str) => {\n    for (let k of list) {\n        var date = new Date(k[str]).toJSON()\n        k[str] = new Date(+new Date(date) + 8 * 3600 * 1000).toISOString().replace(/T/g, ' ').replace(/\\.[\\d]{3}Z/, '')\n    }\n    return list;\n}\n\nexport default renderTime","<template>\n  <div>\n    <!-- 面包屑区域 -->\n    <el-breadcrumb separator=\"/\">\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>角色管理</el-breadcrumb-item>\n    </el-breadcrumb>\n\n    <!-- 卡片区域 -->\n    <el-card class=\"box-card\">\n      <el-row>\n        <el-button type=\"primary\" @click=\"addDialogVisible = true\"\n          ><el-icon><Plus /></el-icon>\n          <span style=\"vertical-align: middle\"> 添加角色 </span></el-button\n        >\n      </el-row>\n      <el-table :data=\"roleList\" style=\"width: 100%\" border stripe>\n        <el-table-column type=\"expand\"></el-table-column>\n        <el-table-column type=\"index\" label=\"#\"></el-table-column>\n        <el-table-column prop=\"roleName\" label=\"角色\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"description\" label=\"描述\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"status\" label=\"状态\" width=\"80\">\n          <template v-slot=\"slotProps\">\n            <div>\n              <el-icon style=\"color: #67c23a\" v-if=\"slotProps.row.status == 1\"\n                ><CircleCheck\n              /></el-icon>\n              <el-icon style=\"color: #f56c6c\" v-else><CircleClose /></el-icon>\n            </div>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"createTime\" label=\"注册时间\" width=\"180\">\n        </el-table-column>\n        <el-table-column label=\"操作\">\n          <template v-slot=\"slotProps\">\n            <el-tooltip content=\"修改角色\" placement=\"top\">\n              <el-button\n                type=\"primary\"\n                size=\"default\"\n                @click=\"showEditDialog(slotProps.row.id)\"\n              >\n                <el-icon style=\"vertical-align: middle\">\n                  <Edit />\n                </el-icon>\n              </el-button>\n            </el-tooltip>\n            <el-tooltip content=\"删除角色\" placement=\"top\">\n              <el-button type=\"danger\" @click=\"removeRole(slotProps.row.id)\">\n                <el-icon style=\"vertical-align: middle\">\n                  <Delete />\n                </el-icon>\n              </el-button>\n            </el-tooltip>\n            <el-tooltip content=\"分配权限\" placement=\"top\">\n              <el-button\n                type=\"warning\"\n                @click=\"showRightDialog(slotProps.row.id)\"\n              >\n                <el-icon style=\"vertical-align: middle\"><Finished /></el-icon>\n              </el-button>\n            </el-tooltip>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <!-- 添加用户对话框 -->\n    <el-dialog\n      v-model=\"addDialogVisible\"\n      title=\"添加新角色\"\n      width=\"40%\"\n      @close=\"addDialogClosed\"\n    >\n      <el-form\n        ref=\"addFormRef\"\n        :model=\"role\"\n        :rules=\"addFormRules\"\n        label-width=\"80px\"\n      >\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\n          <el-input v-model=\"role.roleName\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色描述\" prop=\"description\">\n          <el-input v-model=\"role.description\"></el-input>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"addDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"addRole\"> 确定 </el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 修改用户对话框 -->\n    <el-dialog v-model=\"editDialogVisible\" title=\"修改角色信息\" width=\"40%\">\n      <el-form\n        ref=\"editFormRef\"\n        :model=\"editForm\"\n        :rules=\"editFormRules\"\n        label-width=\"80px\"\n      >\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\n          <el-input v-model=\"editForm.roleName\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色描述\" prop=\"description\">\n          <el-input v-model=\"editForm.description\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色状态\">\n          <el-select v-model=\"editForm.status\" class=\"m-2\" size=\"large\">\n    <el-option\n      label=\"启用\"\n      :value=\"1\"\n    />\n    <el-option\n      label=\"禁用\"\n      :value=\"0\"\n    />\n  </el-select>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"editDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"editRole\"> 确定 </el-button>\n        </span>\n      </template>\n    </el-dialog>\n\n    <!-- 分配权限对话框 -->\n    <el-dialog\n      v-model=\"ShowRightDialogVisible\"\n      @close=\"rightDialogClosed\"\n      title=\"分配权限\"\n      width=\"40%\"\n    >\n      <el-tree\n        :data=\"rightList\"\n        :props=\"defaultProps\"\n        node-key=\"id\"\n        show-checkbox\n        default-expand-all\n        :default-checked-keys=\"defKeys\"\n        ref=\"treeRef\"\n      />\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"ShowRightDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"assignmentRight\"> 确定 </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport FormatTime from '@/renderTime'\nexport default {\n  data() {\n    return {\n      // 角色列表\n      roleList: [],\n      // 树形权限展示列表\n      rightList: [],\n      rolePermissions: [],\n      role: {\n        createTime: '',\n        deleted: 0,\n        description: '',\n        id: 0,\n        roleName: '',\n        status: 0,\n        updateTime: ''\n      },\n      editForm: {},\n      // 添加角色对话框的显示与隐藏\n      addDialogVisible: false,\n      // 修改角色对话框的显示与隐藏\n      editDialogVisible: false,\n      // 分配权限对话框的显示与隐藏\n      ShowRightDialogVisible: false,\n      addFormRules: {\n        roleName: [\n          { required: true, message: '请输入角色名', trigger: 'blur' }\n        ],\n        description: [\n          { required: true, message: '请输入角色描述', trigger: 'blur' }\n        ]\n      },\n      editFormRules: {\n        roleName: [\n          { required: true, message: '请输入角色名', trigger: 'blur' }\n        ],\n        description: [\n          { required: true, message: '请输入角色描述', trigger: 'blur' }\n        ]\n      },\n      // 树形的配置对象\n      defaultProps: {\n        children: 'childern',\n        label: 'description'\n      },\n      // 角色以分配的权限，默认选中的节点id数组\n      defKeys: [],\n      // 当前分配权限的角色id\n      roleId: ''\n    }\n  },\n  created() {\n    this.getRoles()\n    this.getRolePermission()\n  },\n  methods: {\n    // 获取角色列表\n    async getRoles() {\n      const { data: res } = await this.$http.get('/api/role/all')\n      if (!res.success) return this.$message.error('获取角色列表失败!')\n      const data = res.data.roles\n      FormatTime(data, 'createTime')\n      this.roleList = data\n      console.log(this.roleList)\n    },\n    async getRolePermission() {\n      const { data: res } = await this.$http.get('/api/rolePermission/all')\n      console.log(res)\n      if (!res.success) return this.$message.error('获取角色权限列表失败!')\n      const data = res.data.rolePermissions\n      this.rolePermissions = data\n      console.log(this.rolePermissions)\n    },\n    // 获取修改角色的信息\n    async showEditDialog(id) {\n      const { data: res } = await this.$http.get('/api/role/one', {\n        params: { id: id }\n      })\n      console.log(id)\n      if (!res.success) {\n        return this.$message.error('查询角色信息失败!')\n      }\n      console.log(res.data.role)\n      this.editForm = res.data.role\n      this.editDialogVisible = true\n    },\n    // 添加角色\n    addRole() {\n      this.$refs.addFormRef.validate(async (valid) => {\n        if (!valid) return false\n        const { data: res } = await this.$http.post('/api/role/add', this.role)\n        console.log(res)\n        if (!res.success) return this.$message.error('添加角色权限失败！')\n        this.addDialogVisible = false\n        this.getRoles()\n        this.$message.success('添加角色权限成功！')\n      })\n    },\n    // 提交修改角色的信息\n    editRole() {\n      this.$refs.editFormRef.validate(async (valid) => {\n        if (!valid) return false\n        const { data: res } = await this.$http.post(\n          '/api/role/edit',\n          this.editForm\n        )\n        if (!res.success) return this.$message.error('修改角色信息失败！')\n        this.editDialogVisible = false\n        this.getRoles()\n        this.$message.success('修改角色信息成功！')\n      })\n    },\n    // 删除角色\n    async removeRole(id) {\n      const confirmResult = await this.$confirm(\n        '是否永久删除该角色?',\n        '删除角色',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).catch((err) => err)\n\n      // 点击确认，返回值为字符串 confirm\n      // 点击删除，返回值为字符串 cancel\n      if (confirmResult !== 'confirm') return this.$message.info('取消删除')\n      const { data: res } = await this.$http.get('/api/role/delete', {\n        params: { id: id }\n      })\n      console.log(res)\n      if (!res.success) return this.$message.error(res.msg)\n      this.getRoles()\n      this.$message.success(res.msg)\n    },\n    showRightDialog(id) {\n      this.roleId = id\n      const roleIdIndex = this.rolePermissions.findIndex((item) => {\n        return item.roleId == id\n      })\n      this.$http.get('/api/permission/tree').then((res) => {\n        this.rightList = res.data.data.tree\n        console.log(roleIdIndex)\n        if (roleIdIndex != -1) {\n          this.defKeys =\n            this.rolePermissions[roleIdIndex].permissionIds.split(',')\n          console.log(this.defKeys)\n        }\n      })\n      this.ShowRightDialogVisible = true\n    },\n    // 监听添加角色对话框关闭清除数据\n    addDialogClosed() {\n      this.$refs.addFormRef.resetFields()\n    },\n    // 监听分配权限对话框的关闭事件\n    rightDialogClosed() {\n      this.defKeys = []\n    },\n    // 确认分配权限的事件\n    async assignmentRight() {\n      const keys = [\n        ...this.$refs.treeRef.getCheckedKeys(),\n        ...this.$refs.treeRef.getHalfCheckedNodes()\n      ]\n      console.log(keys.join())\n      const { data: res } = await this.$http.post('/api/rolePermission/edit', {\n        createTime: '',\n        id: 0,\n        permissionIds: keys.join(),\n        roleId: this.roleId,\n        updateTime: ''\n      })\n      console.log(res)\n      if (!res.success) return this.$message.error('分配权限失败')\n      this.$message.success('分配权限成功')\n      this.getRoles()\n      this.getRolePermission()\n      this.ShowRightDialogVisible = false\n    }\n  }\n}\n</script>\n","import { render } from \"./Roles.vue?vue&type=template&id=388d1676\"\nimport script from \"./Roles.vue?vue&type=script&lang=js\"\nexport * from \"./Roles.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["renderTime","list","str","k","date","Date","toJSON","toISOString","replace","_createElementVNode","style","class","_createElementBlock","_createVNode","_component_el_breadcrumb","separator","_component_el_breadcrumb_item","to","path","_component_el_card","_component_el_row","_component_el_button","type","onClick","_cache","$event","$data","addDialogVisible","_component_el_icon","_component_Plus","_hoisted_1","_component_el_table","data","roleList","border","stripe","_component_el_table_column","label","prop","width","slotProps","row","status","_createBlock","_component_CircleCheck","_component_CircleClose","_component_el_tooltip","content","placement","size","$options","showEditDialog","id","_component_Edit","removeRole","_component_Delete","showRightDialog","_component_Finished","_component_el_dialog","title","onClose","addDialogClosed","footer","_withCtx","_hoisted_2","addRole","_component_el_form","ref","model","role","rules","addFormRules","_component_el_form_item","_component_el_input","roleName","description","editDialogVisible","_hoisted_3","editRole","editForm","editFormRules","_component_el_select","_component_el_option","value","ShowRightDialogVisible","rightDialogClosed","_hoisted_4","assignmentRight","_component_el_tree","rightList","props","defaultProps","defKeys","rolePermissions","createTime","deleted","updateTime","required","message","trigger","children","roleId","created","this","getRoles","getRolePermission","methods","async","res","$http","get","success","$message","error","roles","FormatTime","console","log","params","$refs","addFormRef","validate","valid","post","editFormRef","confirmResult","$confirm","confirmButtonText","cancelButtonText","catch","err","info","msg","roleIdIndex","findIndex","item","then","tree","permissionIds","split","resetFields","keys","treeRef","getCheckedKeys","getHalfCheckedNodes","join","__exports__","render"],"sourceRoot":""}